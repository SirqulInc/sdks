#' Sirqul IoT Platform
#'
#' Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
#'
#' The version of the OpenAPI document: 3.16
#' Contact: info@sirqul.com
#' Generated by: https://openapi-generator.tech
#'
#' @docType class
#' @title Disbursement operations
#' @description DisbursementApi
#' @format An \code{R6Class} generator object
#' @field api_client Handles the client-server communication.
#'
#' @examples
#' \dontrun{
#' ####################  CheckDisbursements  ####################
#'
#' library(openapi)
#' var_disbursement_id <- 56 # integer | the ID of the disbursement being checked on
#'
#' #Check Disbursements
#' api_instance <- DisbursementApi$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$CheckDisbursements(var_disbursement_iddata_file = "result.txt")
#' result <- api_instance$CheckDisbursements(var_disbursement_id)
#' dput(result)
#'
#'
#' ####################  CreateDisbursement  ####################
#'
#' library(openapi)
#' var_account_id <- 56 # integer | the ID of the logging in user (must be an EXECUTIVE account)
#' var_receiver_account_id <- 56 # integer | the ID of the account receiving the disbursement
#' var_original_sender_account_id <- 56 # integer | the ID of the original sender account
#' var_amount <- 3.4 # numeric | the dollar amount of the disbursement
#' var_provider <- "provider_example" # character | the provider (e.g. Authorize.net, Bill.com, etc.)
#' var_scheduled_date <- 56 # integer | the date that the disbursement is scheduled to go out to the payment provider (Optional)
#' var_title <- "title_example" # character | a title given for the disbursement (Optional)
#' var_comment <- "comment_example" # character | a comment that could be made for a disbursement (Optional)
#' var_external_id <- "external_id_example" # character | external ID, which can be used as a way to reference the disbursement (Optional)
#' var_introspection_params <- "introspection_params_example" # character | This is for specifying parameters to make an http callback request for validating that the disbursement is valid (Optional)
#'
#' #Create Disbursement
#' api_instance <- DisbursementApi$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$CreateDisbursement(var_account_id, var_receiver_account_id, var_original_sender_account_id, var_amount, var_provider, scheduled_date = var_scheduled_date, title = var_title, comment = var_comment, external_id = var_external_id, introspection_params = var_introspection_paramsdata_file = "result.txt")
#' result <- api_instance$CreateDisbursement(var_account_id, var_receiver_account_id, var_original_sender_account_id, var_amount, var_provider, scheduled_date = var_scheduled_date, title = var_title, comment = var_comment, external_id = var_external_id, introspection_params = var_introspection_params)
#' dput(result)
#'
#'
#' ####################  GetDisbursement  ####################
#'
#' library(openapi)
#' var_account_id <- 56 # integer | The logged in user.
#' var_disbursement_id <- 56 # integer | the id of the disbursement
#'
#' #Get Disbursement
#' api_instance <- DisbursementApi$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$GetDisbursement(var_account_id, var_disbursement_iddata_file = "result.txt")
#' result <- api_instance$GetDisbursement(var_account_id, var_disbursement_id)
#' dput(result)
#'
#'
#' ####################  SearchDisbursements  ####################
#'
#' library(openapi)
#' var_account_id <- 56 # integer | the id of the logged in user
#' var_receiver_account_id <- 56 # integer | filter results by the id of the account receiving the disbursement (Optional)
#' var_statuses <- "statuses_example" # character | comma separated list of status values to search for, possilbe values include: NEW, APPROVED, VALIDATING, ERROR, AUTHORIZED, CAPTURED, SETTLED (Optional)
#' var_providers <- "providers_example" # character | comma separated list of payment providers to search for, possbile values include: AUTHORIZE_NET, AMAZON_FPS, BILL_COM (Optional)
#' var_before_date <- 56 # integer | the date for searching disbursements before it has been processed (Optional)
#' var_after_date <- 56 # integer | the date for searching disbursements before it has been processed (Optional)
#' var_start <- 0 # integer | the start index for pagination (Optional)
#' var_limit <- 20 # integer | the limit per result set for pagination (Optional)
#' var_active_only <- FALSE # character | search on disbursements that are active only (Optional)
#' var_external_id <- "external_id_example" # character | search results by this external ID (that can be used to reference the disbursement) (Optional)
#'
#' #Search Disbursements
#' api_instance <- DisbursementApi$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$SearchDisbursements(var_account_id, receiver_account_id = var_receiver_account_id, statuses = var_statuses, providers = var_providers, before_date = var_before_date, after_date = var_after_date, start = var_start, limit = var_limit, active_only = var_active_only, external_id = var_external_iddata_file = "result.txt")
#' result <- api_instance$SearchDisbursements(var_account_id, receiver_account_id = var_receiver_account_id, statuses = var_statuses, providers = var_providers, before_date = var_before_date, after_date = var_after_date, start = var_start, limit = var_limit, active_only = var_active_only, external_id = var_external_id)
#' dput(result)
#'
#'
#' ####################  UpdateDisbursement  ####################
#'
#' library(openapi)
#' var_account_id <- 56 # integer | the id of the logged in user
#' var_disbursement_id <- 56 # integer | the id of the disbursement being updated
#' var_amount <- 3.4 # numeric | the disbursement dollar amount being updated (Optional)
#' var_provider <- "provider_example" # character | the payments and/or billing provider (e.g. Authorize.net, Bill.com, etc.) (Optional)
#' var_scheduled_date <- 56 # integer | the date that the disbursement is scheduled to go out to the payment provider (Optional)
#' var_title <- "title_example" # character | the title given to the disbursement (Optional)
#' var_comment <- "comment_example" # character | a comment that can be made on a disbursement (Optional)
#' var_external_id <- "external_id_example" # character | an external ID that can be used to reference the disbursement (Optional)
#' var_retry <- "retry_example" # character | determines whether to try sending the disbursement again in the case of a previous failure (Optional)
#' var_introspection_params <- "introspection_params_example" # character | for specifying parameters to make an http callback request for validating that the disbursement is valid (Optional)
#'
#' #Update Disbursement
#' api_instance <- DisbursementApi$new()
#'
#' # to save the result into a file, simply add the optional `data_file` parameter, e.g.
#' # result <- api_instance$UpdateDisbursement(var_account_id, var_disbursement_id, amount = var_amount, provider = var_provider, scheduled_date = var_scheduled_date, title = var_title, comment = var_comment, external_id = var_external_id, retry = var_retry, introspection_params = var_introspection_paramsdata_file = "result.txt")
#' result <- api_instance$UpdateDisbursement(var_account_id, var_disbursement_id, amount = var_amount, provider = var_provider, scheduled_date = var_scheduled_date, title = var_title, comment = var_comment, external_id = var_external_id, retry = var_retry, introspection_params = var_introspection_params)
#' dput(result)
#'
#'
#' }
#' @importFrom R6 R6Class
#' @importFrom base64enc base64encode
#' @export
DisbursementApi <- R6::R6Class(
  "DisbursementApi",
  public = list(
    api_client = NULL,

    #' @description
    #' Initialize a new DisbursementApi.
    #'
    #' @param api_client An instance of API client.
    initialize = function(api_client) {
      if (!missing(api_client)) {
        self$api_client <- api_client
      } else {
        self$api_client <- ApiClient$new()
      }
    },

    #' @description
    #' Check Disbursements
    #'
    #' @param disbursement_id the ID of the disbursement being checked on
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return DisbursementResponse
    CheckDisbursements = function(disbursement_id, data_file = NULL, ..., .parse = TRUE) {
      local_var_response <- self$CheckDisbursementsWithHttpInfo(disbursement_id, data_file = data_file, ..., .parse = .parse)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' Check Disbursements
    #'
    #' @param disbursement_id the ID of the disbursement being checked on
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return API response (DisbursementResponse) with additional information such as HTTP status code, headers
    CheckDisbursementsWithHttpInfo = function(disbursement_id, data_file = NULL, ..., .parse = TRUE) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`disbursement_id`)) {
        stop("Missing required parameter `disbursement_id`.")
      }

      if (!missing(`disbursement_id`) && is.null(`disbursement_id`)) {
        stop("Invalid value for `disbursement_id` when calling DisbursementApi$CheckDisbursements, `disbursement_id` is not nullable")
      }

      query_params[["disbursementId"]] <- `disbursement_id`

      local_var_url_path <- "/disbursement/check"

      # The Accept request HTTP header
      local_var_accepts <- list("*/*")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }
        if (!.parse) {
          local_var_resp$content <- local_var_resp$response_as_text()
          return(local_var_resp)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "DisbursementResponse"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(content = paste("Server returned ", local_var_resp$status_code, " response status code."),
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new(content = "API client error",
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || all(local_var_resp$response == "")) {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' Create Disbursement
    #'
    #' @param account_id the ID of the logging in user (must be an EXECUTIVE account)
    #' @param receiver_account_id the ID of the account receiving the disbursement
    #' @param original_sender_account_id the ID of the original sender account
    #' @param amount the dollar amount of the disbursement
    #' @param provider the provider (e.g. Authorize.net, Bill.com, etc.)
    #' @param scheduled_date (optional) the date that the disbursement is scheduled to go out to the payment provider
    #' @param title (optional) a title given for the disbursement
    #' @param comment (optional) a comment that could be made for a disbursement
    #' @param external_id (optional) external ID, which can be used as a way to reference the disbursement
    #' @param introspection_params (optional) This is for specifying parameters to make an http callback request for validating that the disbursement is valid
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return DisbursementResponse
    CreateDisbursement = function(account_id, receiver_account_id, original_sender_account_id, amount, provider, scheduled_date = NULL, title = NULL, comment = NULL, external_id = NULL, introspection_params = NULL, data_file = NULL, ..., .parse = TRUE) {
      local_var_response <- self$CreateDisbursementWithHttpInfo(account_id, receiver_account_id, original_sender_account_id, amount, provider, scheduled_date, title, comment, external_id, introspection_params, data_file = data_file, ..., .parse = .parse)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' Create Disbursement
    #'
    #' @param account_id the ID of the logging in user (must be an EXECUTIVE account)
    #' @param receiver_account_id the ID of the account receiving the disbursement
    #' @param original_sender_account_id the ID of the original sender account
    #' @param amount the dollar amount of the disbursement
    #' @param provider the provider (e.g. Authorize.net, Bill.com, etc.)
    #' @param scheduled_date (optional) the date that the disbursement is scheduled to go out to the payment provider
    #' @param title (optional) a title given for the disbursement
    #' @param comment (optional) a comment that could be made for a disbursement
    #' @param external_id (optional) external ID, which can be used as a way to reference the disbursement
    #' @param introspection_params (optional) This is for specifying parameters to make an http callback request for validating that the disbursement is valid
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return API response (DisbursementResponse) with additional information such as HTTP status code, headers
    CreateDisbursementWithHttpInfo = function(account_id, receiver_account_id, original_sender_account_id, amount, provider, scheduled_date = NULL, title = NULL, comment = NULL, external_id = NULL, introspection_params = NULL, data_file = NULL, ..., .parse = TRUE) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`account_id`)) {
        stop("Missing required parameter `account_id`.")
      }

      if (missing(`receiver_account_id`)) {
        stop("Missing required parameter `receiver_account_id`.")
      }

      if (missing(`original_sender_account_id`)) {
        stop("Missing required parameter `original_sender_account_id`.")
      }

      if (missing(`amount`)) {
        stop("Missing required parameter `amount`.")
      }

      if (missing(`provider`)) {
        stop("Missing required parameter `provider`.")
      }

      if (!missing(`account_id`) && is.null(`account_id`)) {
        stop("Invalid value for `account_id` when calling DisbursementApi$CreateDisbursement, `account_id` is not nullable")
      }

      if (!missing(`receiver_account_id`) && is.null(`receiver_account_id`)) {
        stop("Invalid value for `receiver_account_id` when calling DisbursementApi$CreateDisbursement, `receiver_account_id` is not nullable")
      }

      if (!missing(`original_sender_account_id`) && is.null(`original_sender_account_id`)) {
        stop("Invalid value for `original_sender_account_id` when calling DisbursementApi$CreateDisbursement, `original_sender_account_id` is not nullable")
      }

      if (!missing(`amount`) && is.null(`amount`)) {
        stop("Invalid value for `amount` when calling DisbursementApi$CreateDisbursement, `amount` is not nullable")
      }

      if (!missing(`provider`) && is.null(`provider`)) {
        stop("Invalid value for `provider` when calling DisbursementApi$CreateDisbursement, `provider` is not nullable")
      }

      if (!missing(`scheduled_date`) && is.null(`scheduled_date`)) {
        stop("Invalid value for `scheduled_date` when calling DisbursementApi$CreateDisbursement, `scheduled_date` is not nullable")
      }

      if (!missing(`title`) && is.null(`title`)) {
        stop("Invalid value for `title` when calling DisbursementApi$CreateDisbursement, `title` is not nullable")
      }

      if (!missing(`comment`) && is.null(`comment`)) {
        stop("Invalid value for `comment` when calling DisbursementApi$CreateDisbursement, `comment` is not nullable")
      }

      if (!missing(`external_id`) && is.null(`external_id`)) {
        stop("Invalid value for `external_id` when calling DisbursementApi$CreateDisbursement, `external_id` is not nullable")
      }

      if (!missing(`introspection_params`) && is.null(`introspection_params`)) {
        stop("Invalid value for `introspection_params` when calling DisbursementApi$CreateDisbursement, `introspection_params` is not nullable")
      }

      query_params[["accountId"]] <- `account_id`

      query_params[["receiverAccountId"]] <- `receiver_account_id`

      query_params[["originalSenderAccountId"]] <- `original_sender_account_id`

      query_params[["amount"]] <- `amount`

      if (!is.null(`provider`) && !(`provider` %in% c("AUTHORIZE_NET", "AMAZON_FPS", "BILL_COM"))) {
        stop("Invalid value for provider when calling DisbursementApi$CreateDisbursement. Must be [AUTHORIZE_NET, AMAZON_FPS, BILL_COM].")
      }
      query_params[["provider"]] <- `provider`

      query_params[["scheduledDate"]] <- `scheduled_date`

      query_params[["title"]] <- `title`

      query_params[["comment"]] <- `comment`

      query_params[["externalId"]] <- `external_id`

      query_params[["introspectionParams"]] <- `introspection_params`

      local_var_url_path <- "/disbursement/create"

      # The Accept request HTTP header
      local_var_accepts <- list("*/*")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }
        if (!.parse) {
          local_var_resp$content <- local_var_resp$response_as_text()
          return(local_var_resp)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "DisbursementResponse"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(content = paste("Server returned ", local_var_resp$status_code, " response status code."),
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new(content = "API client error",
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || all(local_var_resp$response == "")) {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' Get Disbursement
    #'
    #' @param account_id The logged in user.
    #' @param disbursement_id the id of the disbursement
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return DisbursementResponse
    GetDisbursement = function(account_id, disbursement_id, data_file = NULL, ..., .parse = TRUE) {
      local_var_response <- self$GetDisbursementWithHttpInfo(account_id, disbursement_id, data_file = data_file, ..., .parse = .parse)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' Get Disbursement
    #'
    #' @param account_id The logged in user.
    #' @param disbursement_id the id of the disbursement
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return API response (DisbursementResponse) with additional information such as HTTP status code, headers
    GetDisbursementWithHttpInfo = function(account_id, disbursement_id, data_file = NULL, ..., .parse = TRUE) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`account_id`)) {
        stop("Missing required parameter `account_id`.")
      }

      if (missing(`disbursement_id`)) {
        stop("Missing required parameter `disbursement_id`.")
      }

      if (!missing(`account_id`) && is.null(`account_id`)) {
        stop("Invalid value for `account_id` when calling DisbursementApi$GetDisbursement, `account_id` is not nullable")
      }

      if (!missing(`disbursement_id`) && is.null(`disbursement_id`)) {
        stop("Invalid value for `disbursement_id` when calling DisbursementApi$GetDisbursement, `disbursement_id` is not nullable")
      }

      query_params[["accountId"]] <- `account_id`

      query_params[["disbursementId"]] <- `disbursement_id`

      local_var_url_path <- "/disbursement/get"

      # The Accept request HTTP header
      local_var_accepts <- list("*/*")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }
        if (!.parse) {
          local_var_resp$content <- local_var_resp$response_as_text()
          return(local_var_resp)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "DisbursementResponse"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(content = paste("Server returned ", local_var_resp$status_code, " response status code."),
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new(content = "API client error",
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || all(local_var_resp$response == "")) {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' Search Disbursements
    #'
    #' @param account_id the id of the logged in user
    #' @param receiver_account_id (optional) filter results by the id of the account receiving the disbursement
    #' @param statuses (optional) comma separated list of status values to search for, possilbe values include: NEW, APPROVED, VALIDATING, ERROR, AUTHORIZED, CAPTURED, SETTLED
    #' @param providers (optional) comma separated list of payment providers to search for, possbile values include: AUTHORIZE_NET, AMAZON_FPS, BILL_COM
    #' @param before_date (optional) the date for searching disbursements before it has been processed
    #' @param after_date (optional) the date for searching disbursements before it has been processed
    #' @param start (optional) the start index for pagination (default value: 0)
    #' @param limit (optional) the limit per result set for pagination (default value: 20)
    #' @param active_only (optional) search on disbursements that are active only (default value: FALSE)
    #' @param external_id (optional) search results by this external ID (that can be used to reference the disbursement)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return array[DisbursementResponse]
    SearchDisbursements = function(account_id, receiver_account_id = NULL, statuses = NULL, providers = NULL, before_date = NULL, after_date = NULL, start = 0, limit = 20, active_only = FALSE, external_id = NULL, data_file = NULL, ..., .parse = TRUE) {
      local_var_response <- self$SearchDisbursementsWithHttpInfo(account_id, receiver_account_id, statuses, providers, before_date, after_date, start, limit, active_only, external_id, data_file = data_file, ..., .parse = .parse)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' Search Disbursements
    #'
    #' @param account_id the id of the logged in user
    #' @param receiver_account_id (optional) filter results by the id of the account receiving the disbursement
    #' @param statuses (optional) comma separated list of status values to search for, possilbe values include: NEW, APPROVED, VALIDATING, ERROR, AUTHORIZED, CAPTURED, SETTLED
    #' @param providers (optional) comma separated list of payment providers to search for, possbile values include: AUTHORIZE_NET, AMAZON_FPS, BILL_COM
    #' @param before_date (optional) the date for searching disbursements before it has been processed
    #' @param after_date (optional) the date for searching disbursements before it has been processed
    #' @param start (optional) the start index for pagination (default value: 0)
    #' @param limit (optional) the limit per result set for pagination (default value: 20)
    #' @param active_only (optional) search on disbursements that are active only (default value: FALSE)
    #' @param external_id (optional) search results by this external ID (that can be used to reference the disbursement)
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return API response (array[DisbursementResponse]) with additional information such as HTTP status code, headers
    SearchDisbursementsWithHttpInfo = function(account_id, receiver_account_id = NULL, statuses = NULL, providers = NULL, before_date = NULL, after_date = NULL, start = 0, limit = 20, active_only = FALSE, external_id = NULL, data_file = NULL, ..., .parse = TRUE) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`account_id`)) {
        stop("Missing required parameter `account_id`.")
      }

      if (!missing(`account_id`) && is.null(`account_id`)) {
        stop("Invalid value for `account_id` when calling DisbursementApi$SearchDisbursements, `account_id` is not nullable")
      }

      if (!missing(`receiver_account_id`) && is.null(`receiver_account_id`)) {
        stop("Invalid value for `receiver_account_id` when calling DisbursementApi$SearchDisbursements, `receiver_account_id` is not nullable")
      }

      if (!missing(`statuses`) && is.null(`statuses`)) {
        stop("Invalid value for `statuses` when calling DisbursementApi$SearchDisbursements, `statuses` is not nullable")
      }

      if (!missing(`providers`) && is.null(`providers`)) {
        stop("Invalid value for `providers` when calling DisbursementApi$SearchDisbursements, `providers` is not nullable")
      }

      if (!missing(`before_date`) && is.null(`before_date`)) {
        stop("Invalid value for `before_date` when calling DisbursementApi$SearchDisbursements, `before_date` is not nullable")
      }

      if (!missing(`after_date`) && is.null(`after_date`)) {
        stop("Invalid value for `after_date` when calling DisbursementApi$SearchDisbursements, `after_date` is not nullable")
      }

      if (!missing(`start`) && is.null(`start`)) {
        stop("Invalid value for `start` when calling DisbursementApi$SearchDisbursements, `start` is not nullable")
      }

      if (!missing(`limit`) && is.null(`limit`)) {
        stop("Invalid value for `limit` when calling DisbursementApi$SearchDisbursements, `limit` is not nullable")
      }

      if (!missing(`active_only`) && is.null(`active_only`)) {
        stop("Invalid value for `active_only` when calling DisbursementApi$SearchDisbursements, `active_only` is not nullable")
      }

      if (!missing(`external_id`) && is.null(`external_id`)) {
        stop("Invalid value for `external_id` when calling DisbursementApi$SearchDisbursements, `external_id` is not nullable")
      }

      query_params[["accountId"]] <- `account_id`

      query_params[["receiverAccountId"]] <- `receiver_account_id`

      query_params[["statuses"]] <- `statuses`

      query_params[["providers"]] <- `providers`

      query_params[["beforeDate"]] <- `before_date`

      query_params[["afterDate"]] <- `after_date`

      query_params[["start"]] <- `start`

      query_params[["limit"]] <- `limit`

      query_params[["activeOnly"]] <- `active_only`

      query_params[["externalId"]] <- `external_id`

      local_var_url_path <- "/disbursement/search"

      # The Accept request HTTP header
      local_var_accepts <- list("*/*")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "GET",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }
        if (!.parse) {
          local_var_resp$content <- local_var_resp$response_as_text()
          return(local_var_resp)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "array[DisbursementResponse]"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(content = paste("Server returned ", local_var_resp$status_code, " response status code."),
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new(content = "API client error",
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || all(local_var_resp$response == "")) {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    },

    #' @description
    #' Update Disbursement
    #'
    #' @param account_id the id of the logged in user
    #' @param disbursement_id the id of the disbursement being updated
    #' @param amount (optional) the disbursement dollar amount being updated
    #' @param provider (optional) the payments and/or billing provider (e.g. Authorize.net, Bill.com, etc.)
    #' @param scheduled_date (optional) the date that the disbursement is scheduled to go out to the payment provider
    #' @param title (optional) the title given to the disbursement
    #' @param comment (optional) a comment that can be made on a disbursement
    #' @param external_id (optional) an external ID that can be used to reference the disbursement
    #' @param retry (optional) determines whether to try sending the disbursement again in the case of a previous failure
    #' @param introspection_params (optional) for specifying parameters to make an http callback request for validating that the disbursement is valid
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return DisbursementResponse
    UpdateDisbursement = function(account_id, disbursement_id, amount = NULL, provider = NULL, scheduled_date = NULL, title = NULL, comment = NULL, external_id = NULL, retry = NULL, introspection_params = NULL, data_file = NULL, ..., .parse = TRUE) {
      local_var_response <- self$UpdateDisbursementWithHttpInfo(account_id, disbursement_id, amount, provider, scheduled_date, title, comment, external_id, retry, introspection_params, data_file = data_file, ..., .parse = .parse)
      if (local_var_response$status_code >= 200 && local_var_response$status_code <= 299) {
        return(local_var_response$content)
      } else if (local_var_response$status_code >= 300 && local_var_response$status_code <= 399) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 400 && local_var_response$status_code <= 499) {
        return(local_var_response)
      } else if (local_var_response$status_code >= 500 && local_var_response$status_code <= 599) {
        return(local_var_response)
      }
    },

    #' @description
    #' Update Disbursement
    #'
    #' @param account_id the id of the logged in user
    #' @param disbursement_id the id of the disbursement being updated
    #' @param amount (optional) the disbursement dollar amount being updated
    #' @param provider (optional) the payments and/or billing provider (e.g. Authorize.net, Bill.com, etc.)
    #' @param scheduled_date (optional) the date that the disbursement is scheduled to go out to the payment provider
    #' @param title (optional) the title given to the disbursement
    #' @param comment (optional) a comment that can be made on a disbursement
    #' @param external_id (optional) an external ID that can be used to reference the disbursement
    #' @param retry (optional) determines whether to try sending the disbursement again in the case of a previous failure
    #' @param introspection_params (optional) for specifying parameters to make an http callback request for validating that the disbursement is valid
    #' @param data_file (optional) name of the data file to save the result
    #' @param ... Other optional arguments
    #' @param .parse Logical. If \code{TRUE} then the response will be parsed to a generated type. If \code{FALSE} the response will be returned as unparsed text.
    #'
    #' @return API response (DisbursementResponse) with additional information such as HTTP status code, headers
    UpdateDisbursementWithHttpInfo = function(account_id, disbursement_id, amount = NULL, provider = NULL, scheduled_date = NULL, title = NULL, comment = NULL, external_id = NULL, retry = NULL, introspection_params = NULL, data_file = NULL, ..., .parse = TRUE) {
      args <- list(...)
      query_params <- list()
      header_params <- c()
      form_params <- list()
      file_params <- list()
      local_var_body <- NULL
      oauth_scopes <- NULL
      is_oauth <- FALSE

      if (missing(`account_id`)) {
        stop("Missing required parameter `account_id`.")
      }

      if (missing(`disbursement_id`)) {
        stop("Missing required parameter `disbursement_id`.")
      }

      if (!missing(`account_id`) && is.null(`account_id`)) {
        stop("Invalid value for `account_id` when calling DisbursementApi$UpdateDisbursement, `account_id` is not nullable")
      }

      if (!missing(`disbursement_id`) && is.null(`disbursement_id`)) {
        stop("Invalid value for `disbursement_id` when calling DisbursementApi$UpdateDisbursement, `disbursement_id` is not nullable")
      }

      if (!missing(`amount`) && is.null(`amount`)) {
        stop("Invalid value for `amount` when calling DisbursementApi$UpdateDisbursement, `amount` is not nullable")
      }

      if (!missing(`provider`) && is.null(`provider`)) {
        stop("Invalid value for `provider` when calling DisbursementApi$UpdateDisbursement, `provider` is not nullable")
      }

      if (!missing(`scheduled_date`) && is.null(`scheduled_date`)) {
        stop("Invalid value for `scheduled_date` when calling DisbursementApi$UpdateDisbursement, `scheduled_date` is not nullable")
      }

      if (!missing(`title`) && is.null(`title`)) {
        stop("Invalid value for `title` when calling DisbursementApi$UpdateDisbursement, `title` is not nullable")
      }

      if (!missing(`comment`) && is.null(`comment`)) {
        stop("Invalid value for `comment` when calling DisbursementApi$UpdateDisbursement, `comment` is not nullable")
      }

      if (!missing(`external_id`) && is.null(`external_id`)) {
        stop("Invalid value for `external_id` when calling DisbursementApi$UpdateDisbursement, `external_id` is not nullable")
      }

      if (!missing(`retry`) && is.null(`retry`)) {
        stop("Invalid value for `retry` when calling DisbursementApi$UpdateDisbursement, `retry` is not nullable")
      }

      if (!missing(`introspection_params`) && is.null(`introspection_params`)) {
        stop("Invalid value for `introspection_params` when calling DisbursementApi$UpdateDisbursement, `introspection_params` is not nullable")
      }

      query_params[["accountId"]] <- `account_id`

      query_params[["disbursementId"]] <- `disbursement_id`

      query_params[["amount"]] <- `amount`

      if (!is.null(`provider`) && !(`provider` %in% c("AUTHORIZE_NET", "AMAZON_FPS", "BILL_COM"))) {
        stop("Invalid value for provider when calling DisbursementApi$UpdateDisbursement. Must be [AUTHORIZE_NET, AMAZON_FPS, BILL_COM].")
      }
      query_params[["provider"]] <- `provider`

      query_params[["scheduledDate"]] <- `scheduled_date`

      query_params[["title"]] <- `title`

      query_params[["comment"]] <- `comment`

      query_params[["externalId"]] <- `external_id`

      query_params[["retry"]] <- `retry`

      query_params[["introspectionParams"]] <- `introspection_params`

      local_var_url_path <- "/disbursement/update"

      # The Accept request HTTP header
      local_var_accepts <- list("*/*")

      # The Content-Type representation header
      local_var_content_types <- list()

      local_var_resp <- self$api_client$CallApi(url = paste0(self$api_client$base_path, local_var_url_path),
                                 method = "POST",
                                 query_params = query_params,
                                 header_params = header_params,
                                 form_params = form_params,
                                 file_params = file_params,
                                 accepts = local_var_accepts,
                                 content_types = local_var_content_types,
                                 body = local_var_body,
                                 is_oauth = is_oauth,
                                 oauth_scopes = oauth_scopes,
                                 ...)

      if (local_var_resp$status_code >= 200 && local_var_resp$status_code <= 299) {
        # save response in a file
        if (!is.null(data_file)) {
          self$api_client$WriteFile(local_var_resp, data_file)
        }
        if (!.parse) {
          local_var_resp$content <- local_var_resp$response_as_text()
          return(local_var_resp)
        }

        deserialized_resp_obj <- tryCatch(
          self$api_client$DeserializeResponse(local_var_resp, "DisbursementResponse"),
          error = function(e) {
            stop("Failed to deserialize response")
          }
        )
        local_var_resp$content <- deserialized_resp_obj
        return(local_var_resp)
      } 
      
      local_var_error_msg <- local_var_resp$response_as_text()      
      if (local_var_resp$status_code >= 300 && local_var_resp$status_code <= 399) {
        ApiResponse$new(content = paste("Server returned ", local_var_resp$status_code, " response status code."),
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 400 && local_var_resp$status_code <= 499) {
        ApiResponse$new(content = "API client error",
                        response = local_var_resp,
                        status_code = local_var_resp$status_code)
      } else if (local_var_resp$status_code >= 500 && local_var_resp$status_code <= 599) {
        if (is.null(local_var_resp$response) || all(local_var_resp$response == "")) {
          local_var_resp$response <- "API server error"
        }
        return(local_var_resp)
      }
    }
  )
)
