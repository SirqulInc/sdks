/**
 * Sirqul IoT Platform
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 *
 * The version of the OpenAPI document: 3.16
 * Contact: info@sirqul.com
 *
 * NOTE: This class is auto generated by OpenAPI-Generator 7.20.0-SNAPSHOT.
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


#include "CppRestOpenAPIClient/api/AnalyticsApi.h"
#include "CppRestOpenAPIClient/IHttpBody.h"
#include "CppRestOpenAPIClient/JsonBody.h"
#include "CppRestOpenAPIClient/MultipartFormData.h"

#include <boost/algorithm/string/replace.hpp>

#include <unordered_set>

namespace org {
namespace openapitools {
namespace client {
namespace api {

using namespace org::openapitools::client::model;

AnalyticsApi::AnalyticsApi( std::shared_ptr<const ApiClient> apiClient )
    : m_ApiClient(apiClient)
{
}

AnalyticsApi::~AnalyticsApi()
{
}

pplx::task<std::vector<std::shared_ptr<UserActivityResponse>>> AnalyticsApi::activities(double version, int32_t start, int32_t limit, int64_t accountId) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/api/{version}/analytics/useractivity");
    boost::replace_all(localVarPath, utility::conversions::to_string_t("{") + utility::conversions::to_string_t("version") + utility::conversions::to_string_t("}"), web::uri::encode_uri(ApiClient::parameterToString(version)));

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("AnalyticsApi->activities does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("start")] = ApiClient::parameterToString(start);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("limit")] = ApiClient::parameterToString(limit);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("AnalyticsApi->activities does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling activities: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling activities: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::vector<std::shared_ptr<UserActivityResponse>> localVarResult;

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);
            for( auto& localVarItem : localVarJson.as_array() )
            {
                std::shared_ptr<UserActivityResponse> localVarItemObj;
                ModelBase::fromJson(localVarItem, localVarItemObj);
                localVarResult.push_back(localVarItemObj);
            }
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling activities: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<ChartData>> AnalyticsApi::aggregatedFilteredUsage(double version, boost::optional<utility::string_t> deviceId, boost::optional<int64_t> accountId, boost::optional<int64_t> applicationId, boost::optional<utility::string_t> appKey, boost::optional<int64_t> startDate, boost::optional<int64_t> endDate, boost::optional<utility::string_t> deviceType, boost::optional<utility::string_t> device, boost::optional<utility::string_t> deviceOS, boost::optional<utility::string_t> gender, boost::optional<utility::string_t> ageGroup, boost::optional<utility::string_t> country, boost::optional<utility::string_t> state, boost::optional<utility::string_t> city, boost::optional<utility::string_t> zip, boost::optional<utility::string_t> model, boost::optional<utility::string_t> tag, boost::optional<int64_t> userAccountId, boost::optional<utility::string_t> userAccountDisplay, boost::optional<utility::string_t> userAccountUsername, boost::optional<utility::string_t> groupByRoot, boost::optional<utility::string_t> groupBy, boost::optional<utility::string_t> distinctCount, boost::optional<utility::string_t> sortField, boost::optional<bool> descending, boost::optional<bool> hideUnknown, boost::optional<utility::string_t> responseFormat, boost::optional<int32_t> l, boost::optional<int32_t> limit, boost::optional<double> latitude, boost::optional<double> longitude) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/api/{version}/analytics/aggregatedFilteredUsage");
    boost::replace_all(localVarPath, utility::conversions::to_string_t("{") + utility::conversions::to_string_t("version") + utility::conversions::to_string_t("}"), web::uri::encode_uri(ApiClient::parameterToString(version)));

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("AnalyticsApi->aggregatedFilteredUsage does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    if (deviceId)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceId")] = ApiClient::parameterToString(*deviceId);
    }
    if (accountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(*accountId);
    }
    if (applicationId)
    {
        localVarQueryParams[utility::conversions::to_string_t("applicationId")] = ApiClient::parameterToString(*applicationId);
    }
    if (appKey)
    {
        localVarQueryParams[utility::conversions::to_string_t("appKey")] = ApiClient::parameterToString(*appKey);
    }
    if (startDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("startDate")] = ApiClient::parameterToString(*startDate);
    }
    if (endDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("endDate")] = ApiClient::parameterToString(*endDate);
    }
    if (deviceType)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceType")] = ApiClient::parameterToString(*deviceType);
    }
    if (device)
    {
        localVarQueryParams[utility::conversions::to_string_t("device")] = ApiClient::parameterToString(*device);
    }
    if (deviceOS)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceOS")] = ApiClient::parameterToString(*deviceOS);
    }
    if (gender)
    {
        localVarQueryParams[utility::conversions::to_string_t("gender")] = ApiClient::parameterToString(*gender);
    }
    if (ageGroup)
    {
        localVarQueryParams[utility::conversions::to_string_t("ageGroup")] = ApiClient::parameterToString(*ageGroup);
    }
    if (country)
    {
        localVarQueryParams[utility::conversions::to_string_t("country")] = ApiClient::parameterToString(*country);
    }
    if (state)
    {
        localVarQueryParams[utility::conversions::to_string_t("state")] = ApiClient::parameterToString(*state);
    }
    if (city)
    {
        localVarQueryParams[utility::conversions::to_string_t("city")] = ApiClient::parameterToString(*city);
    }
    if (zip)
    {
        localVarQueryParams[utility::conversions::to_string_t("zip")] = ApiClient::parameterToString(*zip);
    }
    if (model)
    {
        localVarQueryParams[utility::conversions::to_string_t("model")] = ApiClient::parameterToString(*model);
    }
    if (tag)
    {
        localVarQueryParams[utility::conversions::to_string_t("tag")] = ApiClient::parameterToString(*tag);
    }
    if (userAccountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountId")] = ApiClient::parameterToString(*userAccountId);
    }
    if (userAccountDisplay)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountDisplay")] = ApiClient::parameterToString(*userAccountDisplay);
    }
    if (userAccountUsername)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountUsername")] = ApiClient::parameterToString(*userAccountUsername);
    }
    if (groupByRoot)
    {
        localVarQueryParams[utility::conversions::to_string_t("groupByRoot")] = ApiClient::parameterToString(*groupByRoot);
    }
    if (groupBy)
    {
        localVarQueryParams[utility::conversions::to_string_t("groupBy")] = ApiClient::parameterToString(*groupBy);
    }
    if (distinctCount)
    {
        localVarQueryParams[utility::conversions::to_string_t("distinctCount")] = ApiClient::parameterToString(*distinctCount);
    }
    if (sortField)
    {
        localVarQueryParams[utility::conversions::to_string_t("sortField")] = ApiClient::parameterToString(*sortField);
    }
    if (descending)
    {
        localVarQueryParams[utility::conversions::to_string_t("descending")] = ApiClient::parameterToString(*descending);
    }
    if (hideUnknown)
    {
        localVarQueryParams[utility::conversions::to_string_t("hideUnknown")] = ApiClient::parameterToString(*hideUnknown);
    }
    if (responseFormat)
    {
        localVarQueryParams[utility::conversions::to_string_t("responseFormat")] = ApiClient::parameterToString(*responseFormat);
    }
    if (l)
    {
        localVarQueryParams[utility::conversions::to_string_t("_l")] = ApiClient::parameterToString(*l);
    }
    if (limit)
    {
        localVarQueryParams[utility::conversions::to_string_t("limit")] = ApiClient::parameterToString(*limit);
    }
    if (latitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("latitude")] = ApiClient::parameterToString(*latitude);
    }
    if (longitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("longitude")] = ApiClient::parameterToString(*longitude);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("AnalyticsApi->aggregatedFilteredUsage does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling aggregatedFilteredUsage: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling aggregatedFilteredUsage: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<ChartData> localVarResult(new ChartData());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling aggregatedFilteredUsage: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<ChartData>> AnalyticsApi::filteredUsage(double version, boost::optional<utility::string_t> deviceId, boost::optional<int64_t> accountId, boost::optional<int64_t> applicationId, boost::optional<utility::string_t> appKey, boost::optional<int64_t> startDate, boost::optional<int64_t> endDate, boost::optional<utility::string_t> deviceType, boost::optional<utility::string_t> device, boost::optional<utility::string_t> deviceOS, boost::optional<utility::string_t> gender, boost::optional<utility::string_t> ageGroup, boost::optional<utility::string_t> country, boost::optional<utility::string_t> state, boost::optional<utility::string_t> city, boost::optional<utility::string_t> zip, boost::optional<utility::string_t> model, boost::optional<utility::string_t> tag, boost::optional<int64_t> userAccountId, boost::optional<utility::string_t> userAccountDisplay, boost::optional<utility::string_t> userAccountUsername, boost::optional<int64_t> customId, boost::optional<utility::string_t> customType, boost::optional<double> customValue, boost::optional<double> customValue2, boost::optional<int64_t> customLong, boost::optional<int64_t> customLong2, boost::optional<utility::string_t> customMessage, boost::optional<utility::string_t> customMessage2, boost::optional<utility::string_t> groupBy, boost::optional<utility::string_t> distinctCount, boost::optional<utility::string_t> sumColumn, boost::optional<utility::string_t> sortField, boost::optional<bool> descending, boost::optional<bool> hideUnknown, boost::optional<utility::string_t> responseFormat, boost::optional<int32_t> l, boost::optional<int32_t> limit, boost::optional<double> latitude, boost::optional<double> longitude) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/api/{version}/analytics/filteredUsage");
    boost::replace_all(localVarPath, utility::conversions::to_string_t("{") + utility::conversions::to_string_t("version") + utility::conversions::to_string_t("}"), web::uri::encode_uri(ApiClient::parameterToString(version)));

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("AnalyticsApi->filteredUsage does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    if (deviceId)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceId")] = ApiClient::parameterToString(*deviceId);
    }
    if (accountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(*accountId);
    }
    if (applicationId)
    {
        localVarQueryParams[utility::conversions::to_string_t("applicationId")] = ApiClient::parameterToString(*applicationId);
    }
    if (appKey)
    {
        localVarQueryParams[utility::conversions::to_string_t("appKey")] = ApiClient::parameterToString(*appKey);
    }
    if (startDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("startDate")] = ApiClient::parameterToString(*startDate);
    }
    if (endDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("endDate")] = ApiClient::parameterToString(*endDate);
    }
    if (deviceType)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceType")] = ApiClient::parameterToString(*deviceType);
    }
    if (device)
    {
        localVarQueryParams[utility::conversions::to_string_t("device")] = ApiClient::parameterToString(*device);
    }
    if (deviceOS)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceOS")] = ApiClient::parameterToString(*deviceOS);
    }
    if (gender)
    {
        localVarQueryParams[utility::conversions::to_string_t("gender")] = ApiClient::parameterToString(*gender);
    }
    if (ageGroup)
    {
        localVarQueryParams[utility::conversions::to_string_t("ageGroup")] = ApiClient::parameterToString(*ageGroup);
    }
    if (country)
    {
        localVarQueryParams[utility::conversions::to_string_t("country")] = ApiClient::parameterToString(*country);
    }
    if (state)
    {
        localVarQueryParams[utility::conversions::to_string_t("state")] = ApiClient::parameterToString(*state);
    }
    if (city)
    {
        localVarQueryParams[utility::conversions::to_string_t("city")] = ApiClient::parameterToString(*city);
    }
    if (zip)
    {
        localVarQueryParams[utility::conversions::to_string_t("zip")] = ApiClient::parameterToString(*zip);
    }
    if (model)
    {
        localVarQueryParams[utility::conversions::to_string_t("model")] = ApiClient::parameterToString(*model);
    }
    if (tag)
    {
        localVarQueryParams[utility::conversions::to_string_t("tag")] = ApiClient::parameterToString(*tag);
    }
    if (userAccountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountId")] = ApiClient::parameterToString(*userAccountId);
    }
    if (userAccountDisplay)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountDisplay")] = ApiClient::parameterToString(*userAccountDisplay);
    }
    if (userAccountUsername)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAccountUsername")] = ApiClient::parameterToString(*userAccountUsername);
    }
    if (customId)
    {
        localVarQueryParams[utility::conversions::to_string_t("customId")] = ApiClient::parameterToString(*customId);
    }
    if (customType)
    {
        localVarQueryParams[utility::conversions::to_string_t("customType")] = ApiClient::parameterToString(*customType);
    }
    if (customValue)
    {
        localVarQueryParams[utility::conversions::to_string_t("customValue")] = ApiClient::parameterToString(*customValue);
    }
    if (customValue2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customValue2")] = ApiClient::parameterToString(*customValue2);
    }
    if (customLong)
    {
        localVarQueryParams[utility::conversions::to_string_t("customLong")] = ApiClient::parameterToString(*customLong);
    }
    if (customLong2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customLong2")] = ApiClient::parameterToString(*customLong2);
    }
    if (customMessage)
    {
        localVarQueryParams[utility::conversions::to_string_t("customMessage")] = ApiClient::parameterToString(*customMessage);
    }
    if (customMessage2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customMessage2")] = ApiClient::parameterToString(*customMessage2);
    }
    if (groupBy)
    {
        localVarQueryParams[utility::conversions::to_string_t("groupBy")] = ApiClient::parameterToString(*groupBy);
    }
    if (distinctCount)
    {
        localVarQueryParams[utility::conversions::to_string_t("distinctCount")] = ApiClient::parameterToString(*distinctCount);
    }
    if (sumColumn)
    {
        localVarQueryParams[utility::conversions::to_string_t("sumColumn")] = ApiClient::parameterToString(*sumColumn);
    }
    if (sortField)
    {
        localVarQueryParams[utility::conversions::to_string_t("sortField")] = ApiClient::parameterToString(*sortField);
    }
    if (descending)
    {
        localVarQueryParams[utility::conversions::to_string_t("descending")] = ApiClient::parameterToString(*descending);
    }
    if (hideUnknown)
    {
        localVarQueryParams[utility::conversions::to_string_t("hideUnknown")] = ApiClient::parameterToString(*hideUnknown);
    }
    if (responseFormat)
    {
        localVarQueryParams[utility::conversions::to_string_t("responseFormat")] = ApiClient::parameterToString(*responseFormat);
    }
    if (l)
    {
        localVarQueryParams[utility::conversions::to_string_t("_l")] = ApiClient::parameterToString(*l);
    }
    if (limit)
    {
        localVarQueryParams[utility::conversions::to_string_t("limit")] = ApiClient::parameterToString(*limit);
    }
    if (latitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("latitude")] = ApiClient::parameterToString(*latitude);
    }
    if (longitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("longitude")] = ApiClient::parameterToString(*longitude);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("AnalyticsApi->filteredUsage does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling filteredUsage: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling filteredUsage: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<ChartData> localVarResult(new ChartData());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling filteredUsage: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<SirqulResponse>> AnalyticsApi::usage(double version, utility::string_t tag, boost::optional<utility::string_t> deviceId, boost::optional<int64_t> accountId, boost::optional<int64_t> applicationId, boost::optional<utility::string_t> appKey, boost::optional<utility::string_t> appVersion, boost::optional<utility::string_t> device, boost::optional<utility::string_t> deviceType, boost::optional<utility::string_t> deviceOS, boost::optional<utility::string_t> model, boost::optional<double> latitude, boost::optional<double> longitude, boost::optional<int64_t> customId, boost::optional<utility::string_t> customType, boost::optional<int64_t> achievementIncrement, boost::optional<utility::string_t> city, boost::optional<utility::string_t> state, boost::optional<utility::string_t> country, boost::optional<utility::string_t> zip, boost::optional<utility::string_t> locationDescription, boost::optional<int64_t> clientTime, boost::optional<utility::string_t> errorMessage, boost::optional<utility::string_t> ip, boost::optional<utility::string_t> userAgent, boost::optional<bool> backgroundEvent, boost::optional<utility::string_t> customMessage, boost::optional<utility::string_t> customMessage2, boost::optional<double> customValue, boost::optional<double> customValue2, boost::optional<int64_t> customLong, boost::optional<int64_t> customLong2) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/api/{version}/analytics/usage");
    boost::replace_all(localVarPath, utility::conversions::to_string_t("{") + utility::conversions::to_string_t("version") + utility::conversions::to_string_t("}"), web::uri::encode_uri(ApiClient::parameterToString(version)));

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("AnalyticsApi->usage does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("tag")] = ApiClient::parameterToString(tag);
    }
    if (deviceId)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceId")] = ApiClient::parameterToString(*deviceId);
    }
    if (accountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(*accountId);
    }
    if (applicationId)
    {
        localVarQueryParams[utility::conversions::to_string_t("applicationId")] = ApiClient::parameterToString(*applicationId);
    }
    if (appKey)
    {
        localVarQueryParams[utility::conversions::to_string_t("appKey")] = ApiClient::parameterToString(*appKey);
    }
    if (appVersion)
    {
        localVarQueryParams[utility::conversions::to_string_t("appVersion")] = ApiClient::parameterToString(*appVersion);
    }
    if (device)
    {
        localVarQueryParams[utility::conversions::to_string_t("device")] = ApiClient::parameterToString(*device);
    }
    if (deviceType)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceType")] = ApiClient::parameterToString(*deviceType);
    }
    if (deviceOS)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceOS")] = ApiClient::parameterToString(*deviceOS);
    }
    if (model)
    {
        localVarQueryParams[utility::conversions::to_string_t("model")] = ApiClient::parameterToString(*model);
    }
    if (latitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("latitude")] = ApiClient::parameterToString(*latitude);
    }
    if (longitude)
    {
        localVarQueryParams[utility::conversions::to_string_t("longitude")] = ApiClient::parameterToString(*longitude);
    }
    if (customId)
    {
        localVarQueryParams[utility::conversions::to_string_t("customId")] = ApiClient::parameterToString(*customId);
    }
    if (customType)
    {
        localVarQueryParams[utility::conversions::to_string_t("customType")] = ApiClient::parameterToString(*customType);
    }
    if (achievementIncrement)
    {
        localVarQueryParams[utility::conversions::to_string_t("achievementIncrement")] = ApiClient::parameterToString(*achievementIncrement);
    }
    if (city)
    {
        localVarQueryParams[utility::conversions::to_string_t("city")] = ApiClient::parameterToString(*city);
    }
    if (state)
    {
        localVarQueryParams[utility::conversions::to_string_t("state")] = ApiClient::parameterToString(*state);
    }
    if (country)
    {
        localVarQueryParams[utility::conversions::to_string_t("country")] = ApiClient::parameterToString(*country);
    }
    if (zip)
    {
        localVarQueryParams[utility::conversions::to_string_t("zip")] = ApiClient::parameterToString(*zip);
    }
    if (locationDescription)
    {
        localVarQueryParams[utility::conversions::to_string_t("locationDescription")] = ApiClient::parameterToString(*locationDescription);
    }
    if (clientTime)
    {
        localVarQueryParams[utility::conversions::to_string_t("clientTime")] = ApiClient::parameterToString(*clientTime);
    }
    if (errorMessage)
    {
        localVarQueryParams[utility::conversions::to_string_t("errorMessage")] = ApiClient::parameterToString(*errorMessage);
    }
    if (ip)
    {
        localVarQueryParams[utility::conversions::to_string_t("ip")] = ApiClient::parameterToString(*ip);
    }
    if (userAgent)
    {
        localVarQueryParams[utility::conversions::to_string_t("userAgent")] = ApiClient::parameterToString(*userAgent);
    }
    if (backgroundEvent)
    {
        localVarQueryParams[utility::conversions::to_string_t("backgroundEvent")] = ApiClient::parameterToString(*backgroundEvent);
    }
    if (customMessage)
    {
        localVarQueryParams[utility::conversions::to_string_t("customMessage")] = ApiClient::parameterToString(*customMessage);
    }
    if (customMessage2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customMessage2")] = ApiClient::parameterToString(*customMessage2);
    }
    if (customValue)
    {
        localVarQueryParams[utility::conversions::to_string_t("customValue")] = ApiClient::parameterToString(*customValue);
    }
    if (customValue2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customValue2")] = ApiClient::parameterToString(*customValue2);
    }
    if (customLong)
    {
        localVarQueryParams[utility::conversions::to_string_t("customLong")] = ApiClient::parameterToString(*customLong);
    }
    if (customLong2)
    {
        localVarQueryParams[utility::conversions::to_string_t("customLong2")] = ApiClient::parameterToString(*customLong2);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("AnalyticsApi->usage does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("POST"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling usage: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling usage: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<SirqulResponse> localVarResult(new SirqulResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling usage: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<SirqulResponse>> AnalyticsApi::usageBatch(double version, utility::string_t appKey, utility::string_t device, utility::string_t data, boost::optional<utility::string_t> deviceId, boost::optional<int64_t> accountId, boost::optional<utility::string_t> appVersion, boost::optional<utility::string_t> deviceType, boost::optional<utility::string_t> deviceOS, boost::optional<utility::string_t> model, boost::optional<bool> updateRanking, boost::optional<bool> returnSummaryResponse) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/api/{version}/analytics/usage/batch");
    boost::replace_all(localVarPath, utility::conversions::to_string_t("{") + utility::conversions::to_string_t("version") + utility::conversions::to_string_t("}"), web::uri::encode_uri(ApiClient::parameterToString(version)));

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("AnalyticsApi->usageBatch does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("appKey")] = ApiClient::parameterToString(appKey);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("device")] = ApiClient::parameterToString(device);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("data")] = ApiClient::parameterToString(data);
    }
    if (deviceId)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceId")] = ApiClient::parameterToString(*deviceId);
    }
    if (accountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(*accountId);
    }
    if (appVersion)
    {
        localVarQueryParams[utility::conversions::to_string_t("appVersion")] = ApiClient::parameterToString(*appVersion);
    }
    if (deviceType)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceType")] = ApiClient::parameterToString(*deviceType);
    }
    if (deviceOS)
    {
        localVarQueryParams[utility::conversions::to_string_t("deviceOS")] = ApiClient::parameterToString(*deviceOS);
    }
    if (model)
    {
        localVarQueryParams[utility::conversions::to_string_t("model")] = ApiClient::parameterToString(*model);
    }
    if (updateRanking)
    {
        localVarQueryParams[utility::conversions::to_string_t("updateRanking")] = ApiClient::parameterToString(*updateRanking);
    }
    if (returnSummaryResponse)
    {
        localVarQueryParams[utility::conversions::to_string_t("returnSummaryResponse")] = ApiClient::parameterToString(*returnSummaryResponse);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("AnalyticsApi->usageBatch does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("POST"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling usageBatch: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling usageBatch: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<SirqulResponse> localVarResult(new SirqulResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling usageBatch: unsupported response type"));
        }

        return localVarResult;
    });
}

}
}
}
}

