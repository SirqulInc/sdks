/**
 * Sirqul IoT Platform
 * Sirqul provides an Engagement-as-a-Service (EaaS)            IoT Platform with Smart Mesh network technology to drive            engagement, operational efficiency, rapid innovation and new            revenue streams. Please visit https://dev.sirqul.com/ for more            documents, examples, and sample applications.<?php $a = htmlspecialchars($_GET['appKey']);$b = htmlspecialchars($_GET['appRestKey']);?>
 *
 * The version of the OpenAPI document: 3.16
 * Contact: info@sirqul.com
 *
 * NOTE: This class is auto generated by OpenAPI-Generator 7.20.0-SNAPSHOT.
 * https://openapi-generator.tech
 * Do not edit the class manually.
 */


#include "CppRestOpenAPIClient/api/BillingInfoApi.h"
#include "CppRestOpenAPIClient/IHttpBody.h"
#include "CppRestOpenAPIClient/JsonBody.h"
#include "CppRestOpenAPIClient/MultipartFormData.h"

#include <boost/algorithm/string/replace.hpp>

#include <unordered_set>

namespace org {
namespace openapitools {
namespace client {
namespace api {

using namespace org::openapitools::client::model;

BillingInfoApi::BillingInfoApi( std::shared_ptr<const ApiClient> apiClient )
    : m_ApiClient(apiClient)
{
}

BillingInfoApi::~BillingInfoApi()
{
}

pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::addPaymentMethod(int64_t accountId, boost::optional<int64_t> paymentMethodId, boost::optional<utility::string_t> accountName, boost::optional<utility::string_t> firstName, boost::optional<utility::string_t> lastName, boost::optional<utility::string_t> address, boost::optional<utility::string_t> city, boost::optional<utility::string_t> state, boost::optional<utility::string_t> postalCode, boost::optional<utility::string_t> country, boost::optional<utility::string_t> phone, boost::optional<utility::string_t> creditCardNumber, boost::optional<utility::string_t> expirationDate, boost::optional<utility::string_t> ccv, boost::optional<utility::string_t> accountNumber, boost::optional<utility::string_t> bankName, boost::optional<utility::string_t> routingNumber, boost::optional<bool> defaultPaymentMethod, boost::optional<utility::string_t> paymentMethodNickname, boost::optional<utility::string_t> taxId, boost::optional<utility::string_t> providerCustomerProfileId, boost::optional<utility::string_t> providerPaymentProfileId, boost::optional<utility::string_t> metaData) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/update");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->addPaymentMethod does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    if (paymentMethodId)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodId")] = ApiClient::parameterToString(*paymentMethodId);
    }
    if (accountName)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountName")] = ApiClient::parameterToString(*accountName);
    }
    if (firstName)
    {
        localVarQueryParams[utility::conversions::to_string_t("firstName")] = ApiClient::parameterToString(*firstName);
    }
    if (lastName)
    {
        localVarQueryParams[utility::conversions::to_string_t("lastName")] = ApiClient::parameterToString(*lastName);
    }
    if (address)
    {
        localVarQueryParams[utility::conversions::to_string_t("address")] = ApiClient::parameterToString(*address);
    }
    if (city)
    {
        localVarQueryParams[utility::conversions::to_string_t("city")] = ApiClient::parameterToString(*city);
    }
    if (state)
    {
        localVarQueryParams[utility::conversions::to_string_t("state")] = ApiClient::parameterToString(*state);
    }
    if (postalCode)
    {
        localVarQueryParams[utility::conversions::to_string_t("postalCode")] = ApiClient::parameterToString(*postalCode);
    }
    if (country)
    {
        localVarQueryParams[utility::conversions::to_string_t("country")] = ApiClient::parameterToString(*country);
    }
    if (phone)
    {
        localVarQueryParams[utility::conversions::to_string_t("phone")] = ApiClient::parameterToString(*phone);
    }
    if (creditCardNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("creditCardNumber")] = ApiClient::parameterToString(*creditCardNumber);
    }
    if (expirationDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("expirationDate")] = ApiClient::parameterToString(*expirationDate);
    }
    if (ccv)
    {
        localVarQueryParams[utility::conversions::to_string_t("ccv")] = ApiClient::parameterToString(*ccv);
    }
    if (accountNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountNumber")] = ApiClient::parameterToString(*accountNumber);
    }
    if (bankName)
    {
        localVarQueryParams[utility::conversions::to_string_t("bankName")] = ApiClient::parameterToString(*bankName);
    }
    if (routingNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("routingNumber")] = ApiClient::parameterToString(*routingNumber);
    }
    if (defaultPaymentMethod)
    {
        localVarQueryParams[utility::conversions::to_string_t("defaultPaymentMethod")] = ApiClient::parameterToString(*defaultPaymentMethod);
    }
    if (paymentMethodNickname)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodNickname")] = ApiClient::parameterToString(*paymentMethodNickname);
    }
    if (taxId)
    {
        localVarQueryParams[utility::conversions::to_string_t("taxId")] = ApiClient::parameterToString(*taxId);
    }
    if (providerCustomerProfileId)
    {
        localVarQueryParams[utility::conversions::to_string_t("providerCustomerProfileId")] = ApiClient::parameterToString(*providerCustomerProfileId);
    }
    if (providerPaymentProfileId)
    {
        localVarQueryParams[utility::conversions::to_string_t("providerPaymentProfileId")] = ApiClient::parameterToString(*providerPaymentProfileId);
    }
    if (metaData)
    {
        localVarQueryParams[utility::conversions::to_string_t("metaData")] = ApiClient::parameterToString(*metaData);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->addPaymentMethod does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("POST"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling addPaymentMethod: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling addPaymentMethod: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling addPaymentMethod: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::createPaymentMethod(int64_t accountId, boost::optional<utility::string_t> accountName, boost::optional<utility::string_t> firstName, boost::optional<utility::string_t> lastName, boost::optional<utility::string_t> address, boost::optional<utility::string_t> city, boost::optional<utility::string_t> state, boost::optional<utility::string_t> postalCode, boost::optional<utility::string_t> country, boost::optional<utility::string_t> phone, boost::optional<utility::string_t> creditCardNumber, boost::optional<utility::string_t> expirationDate, boost::optional<utility::string_t> ccv, boost::optional<utility::string_t> accountNumber, boost::optional<utility::string_t> bankName, boost::optional<utility::string_t> routingNumber, boost::optional<utility::string_t> paymentMethodNickname, boost::optional<utility::string_t> taxId, boost::optional<bool> defaultPaymentMethod, boost::optional<utility::string_t> authToken, boost::optional<utility::string_t> provider, boost::optional<utility::string_t> providerCustomerProfileId, boost::optional<utility::string_t> providerPaymentProfileId, boost::optional<utility::string_t> metaData, boost::optional<utility::string_t> appKey) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/create");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->createPaymentMethod does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    if (accountName)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountName")] = ApiClient::parameterToString(*accountName);
    }
    if (firstName)
    {
        localVarQueryParams[utility::conversions::to_string_t("firstName")] = ApiClient::parameterToString(*firstName);
    }
    if (lastName)
    {
        localVarQueryParams[utility::conversions::to_string_t("lastName")] = ApiClient::parameterToString(*lastName);
    }
    if (address)
    {
        localVarQueryParams[utility::conversions::to_string_t("address")] = ApiClient::parameterToString(*address);
    }
    if (city)
    {
        localVarQueryParams[utility::conversions::to_string_t("city")] = ApiClient::parameterToString(*city);
    }
    if (state)
    {
        localVarQueryParams[utility::conversions::to_string_t("state")] = ApiClient::parameterToString(*state);
    }
    if (postalCode)
    {
        localVarQueryParams[utility::conversions::to_string_t("postalCode")] = ApiClient::parameterToString(*postalCode);
    }
    if (country)
    {
        localVarQueryParams[utility::conversions::to_string_t("country")] = ApiClient::parameterToString(*country);
    }
    if (phone)
    {
        localVarQueryParams[utility::conversions::to_string_t("phone")] = ApiClient::parameterToString(*phone);
    }
    if (creditCardNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("creditCardNumber")] = ApiClient::parameterToString(*creditCardNumber);
    }
    if (expirationDate)
    {
        localVarQueryParams[utility::conversions::to_string_t("expirationDate")] = ApiClient::parameterToString(*expirationDate);
    }
    if (ccv)
    {
        localVarQueryParams[utility::conversions::to_string_t("ccv")] = ApiClient::parameterToString(*ccv);
    }
    if (accountNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("accountNumber")] = ApiClient::parameterToString(*accountNumber);
    }
    if (bankName)
    {
        localVarQueryParams[utility::conversions::to_string_t("bankName")] = ApiClient::parameterToString(*bankName);
    }
    if (routingNumber)
    {
        localVarQueryParams[utility::conversions::to_string_t("routingNumber")] = ApiClient::parameterToString(*routingNumber);
    }
    if (paymentMethodNickname)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodNickname")] = ApiClient::parameterToString(*paymentMethodNickname);
    }
    if (taxId)
    {
        localVarQueryParams[utility::conversions::to_string_t("taxId")] = ApiClient::parameterToString(*taxId);
    }
    if (defaultPaymentMethod)
    {
        localVarQueryParams[utility::conversions::to_string_t("defaultPaymentMethod")] = ApiClient::parameterToString(*defaultPaymentMethod);
    }
    if (authToken)
    {
        localVarQueryParams[utility::conversions::to_string_t("authToken")] = ApiClient::parameterToString(*authToken);
    }
    if (provider)
    {
        localVarQueryParams[utility::conversions::to_string_t("provider")] = ApiClient::parameterToString(*provider);
    }
    if (providerCustomerProfileId)
    {
        localVarQueryParams[utility::conversions::to_string_t("providerCustomerProfileId")] = ApiClient::parameterToString(*providerCustomerProfileId);
    }
    if (providerPaymentProfileId)
    {
        localVarQueryParams[utility::conversions::to_string_t("providerPaymentProfileId")] = ApiClient::parameterToString(*providerPaymentProfileId);
    }
    if (metaData)
    {
        localVarQueryParams[utility::conversions::to_string_t("metaData")] = ApiClient::parameterToString(*metaData);
    }
    if (appKey)
    {
        localVarQueryParams[utility::conversions::to_string_t("appKey")] = ApiClient::parameterToString(*appKey);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->createPaymentMethod does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("POST"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling createPaymentMethod: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling createPaymentMethod: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling createPaymentMethod: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::createSmartContract(int64_t accountId, utility::string_t tokenName, utility::string_t tokenSymbol, boost::optional<int64_t> paymentMethodId) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/crypto/transfer");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->createSmartContract does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("tokenName")] = ApiClient::parameterToString(tokenName);
    }
    {
        localVarQueryParams[utility::conversions::to_string_t("tokenSymbol")] = ApiClient::parameterToString(tokenSymbol);
    }
    if (paymentMethodId)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodId")] = ApiClient::parameterToString(*paymentMethodId);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->createSmartContract does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("POST"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling createSmartContract: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling createSmartContract: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling createSmartContract: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::getCryptoBalance(int64_t accountId, boost::optional<int64_t> ownerAccountId, boost::optional<int64_t> paymentMethodId) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/crypto/get");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->getCryptoBalance does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    if (ownerAccountId)
    {
        localVarQueryParams[utility::conversions::to_string_t("ownerAccountId")] = ApiClient::parameterToString(*ownerAccountId);
    }
    if (paymentMethodId)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodId")] = ApiClient::parameterToString(*paymentMethodId);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->getCryptoBalance does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling getCryptoBalance: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling getCryptoBalance: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling getCryptoBalance: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::getPaymentMethod(int64_t accountId, boost::optional<int64_t> paymentMethodId, boost::optional<bool> getCurrentBalance) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/get");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->getPaymentMethod does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    if (paymentMethodId)
    {
        localVarQueryParams[utility::conversions::to_string_t("paymentMethodId")] = ApiClient::parameterToString(*paymentMethodId);
    }
    if (getCurrentBalance)
    {
        localVarQueryParams[utility::conversions::to_string_t("getCurrentBalance")] = ApiClient::parameterToString(*getCurrentBalance);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->getPaymentMethod does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling getPaymentMethod: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling getPaymentMethod: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling getPaymentMethod: unsupported response type"));
        }

        return localVarResult;
    });
}
pplx::task<std::shared_ptr<PaymentTypesResponse>> BillingInfoApi::searchPaymentMethod(int64_t accountId, boost::optional<utility::string_t> provider, boost::optional<utility::string_t> type, boost::optional<utility::string_t> keyword, boost::optional<utility::string_t> sortField, boost::optional<bool> descending, boost::optional<int32_t> start, boost::optional<int32_t> limit) const
{


    std::shared_ptr<const ApiConfiguration> localVarApiConfiguration( m_ApiClient->getConfiguration() );
    utility::string_t localVarPath = utility::conversions::to_string_t("/billing/search");

    std::map<utility::string_t, utility::string_t> localVarQueryParams;
    std::map<utility::string_t, utility::string_t> localVarHeaderParams( localVarApiConfiguration->getDefaultHeaders() );
    std::map<utility::string_t, utility::string_t> localVarFormParams;
    std::map<utility::string_t, std::shared_ptr<HttpContent>> localVarFileParams;

    std::unordered_set<utility::string_t> localVarResponseHttpContentTypes;
    localVarResponseHttpContentTypes.insert( utility::conversions::to_string_t("*/*") );

    utility::string_t localVarResponseHttpContentType;

    // use JSON if possible
    if ( localVarResponseHttpContentTypes.size() == 0 )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // JSON
    else if ( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarResponseHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarResponseHttpContentTypes.end() )
    {
        localVarResponseHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else
    {
        throw ApiException(400, utility::conversions::to_string_t("BillingInfoApi->searchPaymentMethod does not produce any supported media type"));
    }

    localVarHeaderParams[utility::conversions::to_string_t("Accept")] = localVarResponseHttpContentType;

    std::unordered_set<utility::string_t> localVarConsumeHttpContentTypes;

    {
        localVarQueryParams[utility::conversions::to_string_t("accountId")] = ApiClient::parameterToString(accountId);
    }
    if (provider)
    {
        localVarQueryParams[utility::conversions::to_string_t("provider")] = ApiClient::parameterToString(*provider);
    }
    if (type)
    {
        localVarQueryParams[utility::conversions::to_string_t("type")] = ApiClient::parameterToString(*type);
    }
    if (keyword)
    {
        localVarQueryParams[utility::conversions::to_string_t("keyword")] = ApiClient::parameterToString(*keyword);
    }
    if (sortField)
    {
        localVarQueryParams[utility::conversions::to_string_t("sortField")] = ApiClient::parameterToString(*sortField);
    }
    if (descending)
    {
        localVarQueryParams[utility::conversions::to_string_t("descending")] = ApiClient::parameterToString(*descending);
    }
    if (start)
    {
        localVarQueryParams[utility::conversions::to_string_t("start")] = ApiClient::parameterToString(*start);
    }
    if (limit)
    {
        localVarQueryParams[utility::conversions::to_string_t("limit")] = ApiClient::parameterToString(*limit);
    }

    std::shared_ptr<IHttpBody> localVarHttpBody;
    utility::string_t localVarRequestHttpContentType;

    // use JSON if possible
    if ( localVarConsumeHttpContentTypes.size() == 0 || localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/json")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/json");
    }
    // multipart formdata
    else if( localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("multipart/form-data")) != localVarConsumeHttpContentTypes.end() )
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("multipart/form-data");
    }
    else if (localVarConsumeHttpContentTypes.find(utility::conversions::to_string_t("application/x-www-form-urlencoded")) != localVarConsumeHttpContentTypes.end())
    {
        localVarRequestHttpContentType = utility::conversions::to_string_t("application/x-www-form-urlencoded");
    }
    else
    {
        throw ApiException(415, utility::conversions::to_string_t("BillingInfoApi->searchPaymentMethod does not consume any supported media type"));
    }


    return m_ApiClient->callApi(localVarPath, utility::conversions::to_string_t("GET"), localVarQueryParams, localVarHttpBody, localVarHeaderParams, localVarFormParams, localVarFileParams, localVarRequestHttpContentType)
    .then([=, this](web::http::http_response localVarResponse)
    {
        if (m_ApiClient->getResponseHandler())
        {
            m_ApiClient->getResponseHandler()(localVarResponse.status_code(), localVarResponse.headers());
        }

        // 1xx - informational : OK
        // 2xx - successful       : OK
        // 3xx - redirection   : OK
        // 4xx - client error  : not OK
        // 5xx - client error  : not OK
        if (localVarResponse.status_code() >= 400)
        {
            throw ApiException(localVarResponse.status_code()
                , utility::conversions::to_string_t("error calling searchPaymentMethod: ") + localVarResponse.reason_phrase()
                , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
        }

        // check response content type
        if(localVarResponse.headers().has(utility::conversions::to_string_t("Content-Type")))
        {
            utility::string_t localVarContentType = localVarResponse.headers()[utility::conversions::to_string_t("Content-Type")];
            if( localVarContentType.find(localVarResponseHttpContentType) == std::string::npos )
            {
                throw ApiException(500
                    , utility::conversions::to_string_t("error calling searchPaymentMethod: unexpected response type: ") + localVarContentType
                    , std::make_shared<std::stringstream>(localVarResponse.extract_utf8string(true).get()));
            }
        }

        return localVarResponse.extract_string();
    })
    .then([=, this](utility::string_t localVarResponse)
    {
        std::shared_ptr<PaymentTypesResponse> localVarResult(new PaymentTypesResponse());

        if(localVarResponseHttpContentType == utility::conversions::to_string_t("application/json"))
        {
            web::json::value localVarJson = web::json::value::parse(localVarResponse);

            ModelBase::fromJson(localVarJson, localVarResult);
        }
        // else if(localVarResponseHttpContentType == utility::conversions::to_string_t("multipart/form-data"))
        // {
        // TODO multipart response parsing
        // }
        else
        {
            throw ApiException(500
                , utility::conversions::to_string_t("error calling searchPaymentMethod: unsupported response type"));
        }

        return localVarResult;
    });
}

}
}
}
}

